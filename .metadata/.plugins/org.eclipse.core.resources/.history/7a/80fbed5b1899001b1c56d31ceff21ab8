package NegoziTreni;

import Fabbriche.FabbricaLocomotive;
import Fabbriche.FabbricaVagoni;
import Fabbriche.FabbricaVagoniBagno;
import Fabbriche.FabbricaVagoniCargo;
import Fabbriche.FabbricaVagoniPasseggeri;
import Fabbriche.FabbricaVagoniRistorante;
import Vagoni.Treno;
import Vagoni.Vagone;

public class NegozioTreni {
	
	public final Treno ordinaTreno(String ordine) throws Exception{
		Treno treno = new Treno();
		if(controllaOrdine(ordine)) {
			for (int i = 0; i < ordine.length(); i++) {
				treno.aggiungiVagone(ordinaVagone(ordine.charAt(i)));
			}
		} else throw new Exception("Il treno non è valido!");
		return treno;
	}
	
	public final Treno aggiungiCarrozza(Treno treno, String tipoCarrozza) throws Exception {
		if(controllaAggiunta(tipoCarrozza)) {
			for (int i = 0; i < tipoCarrozza.length(); i++) {
				treno.aggiungiVagone(ordinaVagone(tipoCarrozza.charAt(i)));
			}
		} else throw new Exception("L'ordine non è valido!");
		return treno;
	}
	
	private boolean controllaOrdine(String ordine) {
		if(ordine.charAt(0) != 'H') return false;
		for (int i = 1; i < ordine.length(); i++)  {
			if(ordine.charAt(i) == 'H') return false;
		}
		return true;
	}
	
	private boolean controllaAggiunta(String ordine) {
		for (int i = 0; i < ordine.length(); i++)  {
			if(ordine.charAt(i) == 'H') return false;;
		}
		return true;
	}
	
	private Vagone ordinaVagone(char vagone) {
		if(vagone == 'H')
			return FabbricaVagoni.costrisciVagone(new FabbricaLocomotive());
		if(vagone == 'R')
			return FabbricaVagoni.costrisciVagone(new FabbricaVagoniRistorante());
		if(vagone == 'C')
			return FabbricaVagoni.costrisciVagone(new FabbricaVagoniCargo());
		if(vagone == 'P')
			return FabbricaVagoni.costrisciVagone(new FabbricaVagoniPasseggeri());
		if(vagone == 'B')
			return FabbricaVagoni.costrisciVagone(new FabbricaVagoniBagno());
		return null;
	}
}
